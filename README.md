# ビジュアルプログラミング IoTLT 第22回

このページは、ビジュアルプログラミング IoTLT 第22回を Rimo という AI 議事録ツールでまとめたものです。

AI が聞き間違ったりまとめ間違う前提でご参考ください。

## イベント情報

ビジュアルプログラミングIoTLT vol.22 - connpass
https://iotlt.connpass.com/event/376450/

## 要約

- ビジュアルプログラミングIoTLT第22回をオンライン配信で開催、毎月開催でラーメン屋や屋形船など変わった会場も採用
- DifyのバージョンアップでMCPとトリガー機能が実装され、ヤフーニュースの自動チェックとSlack通知・Notion記事作成を実現
- マイクロビットの「ずっと」ブロックは50回/秒、「繰り返し」ブロックは17万回/秒と桁違いの処理速度差を確認
- Node-REDでMCPサーバーを構築し、環境センサーデータをLLMが取得・分析して改善提案を生成する仕組みを開発
- AtomS3Rで音声録音サーバーを作成、Node-REDと連携してWhisperAPIによる文字起こしを実現
- M5StackチェーンデュアルキーをUIFlow2.0で試用、WebSerialAPIでブラウザから直接ファームウェア書き込みが可能
- 次回第23回はゴールデンウィーク過ぎ頃開催予定

## 開会とイベント概要説明

- ビジュアルプログラミングIoTLT第22回目の開催を開始し、YouTubeライブでオンライン配信を実施
- FacebookやTwitter(X)でハッシュタグ#IoTLTを使用した情報共有を呼びかけ、ポストやコメントを促進
- コミュニティがボランティアで運営しており、スライド配信やアーカイブが残るため、キャプチャーも可能と説明
- 進行役は豊田陽介が務め、共同主催のビジュアルプログラミング交流会やカンダ道場の活動を紹介
- 正吾さんがローコード・ノードレッドのユーザーグループ運営をしており、裏方としてサポート
- IoTLTは毎月開催されており、最近はラーメン屋貸し切りや屋形船など変わった開催方法を採用
- LT発表は5分を目安とし、コンパスのイベントページに順番が記載されていることを案内



## Difyのバージョンアップと新機能(MCP・トリガー)の活用 - ざっきーさん

- DifyがバージョンアップしてMCPとトリガー機能が実装され、それらを実際に試した成果を報告
- バージョン1.6でMCP対応、1.10でトリガー機能が追加され、Docker起動環境での更新手順は公式手順通りで簡単に実施可能
- MCPはUSB規格に例えられ、様々なサービスと簡単に連携できるが、Proxy環境などの制約を乗り越える必要がある場合も
- DifyではMCPがツールとして登録され、ワークフロー上でブロック追加操作により手動でツールを選択する仕組み
- トリガー機能により定期的にヤフーニュースをチェックしてSlack通知やNotion記事作成を自動化するボットを作成
- ワークフローを作成後、別のトリガー用ワークフローから実行する二段階構造で、UTC-5表示がJST変換の課題として残る
- マネージドサービス版では無料ユーザーはトリガー数に制限があるが、自己構築環境では制限なく利用可能



## マイクロビットの繰り返し処理速度比較 - 村上さん

- マイクロビットのメイクコードで「ずっと」ブロックと「繰り返し」ブロックの処理速度を比較検証
- 5秒間連打ゲームを作成中に繰り返し処理のブレがあり、処理が間に合っていない可能性を感じて調査を開始
- 1秒間にカウントアップする回数を測定した結果、「ずっと」ブロックは50回前後、「繰り返し」ブロックは数百万回という桁違いの差
- 実機での検証でも「繰り返し」ブロックは17万回以上、「ずっと」ブロックは約50回と大きな性能差を確認
- Pythonでも比較したところ、メイクコードの「繰り返し」ブロックよりさらに遅い結果となった
- デフォルトで配置されるブロックは便利だが制限があり、厳密な処理を求める場合は「繰り返し」ブロックの使用を推奨
- 文字表示などの処理でも0.2秒程度の表示が残るなど、わかりやすさのために調整されている機能がある



## ビジュアルプログラミングで作るAIエージェントとMCPサーバー - 勝さん

- Node-REDでMCPサーバーを構築し、LLMのMCPクライアント経由で通信できる仕組みを開発
- Node-REDのデータストア(DB機能)と連携し、環境センサーデータをLLMから取得可能な構成を実現
- Raspberry Pi上のエージェント実行環境でオムロンの環境センサーデータ(温度・湿度・気圧・騒音・CO2)を定期的にアップロード
- ClaudeデスクトップアプリのMCPクライアント機能を使い、1週間分のセンサーデータをLLMに分析させる実験を実施
- LLMが自動的にツールを判断してMCPサーバーにリクエストを作成し、データを取得して環境評価や改善提案を生成
- Node-REDの無料アカウントで十分使用可能で、10分周期のデータ記録なら1ヶ月分でも無料範囲内
- Difyを使ってNode-REDのMCPサーバーと連携し、1週間の総評を自動的にSlackチャンネルへ投稿する仕組みも構築



## AtomS3Rで音声録音サーバーを作りNode-REDと連携 - 正吾さん

- AtomS3Rは内蔵メモリが多く、マイクとスピーカーを搭載しているがディスプレイがない音声デバイス
- ボタンを押して録音開始、再度押して停止、長押しで再生というインタラクションを実装
- デバイス自体がサーバーとなりIPアドレスを持ち、WebhookでNode-REDなど他サービスへ通知可能
- 起動時にIPアドレスをNode-REDへ送信し、Node-RED側から音声データを取得する仕組みを構築
- APIとして録音・再生・停止の制御やデータのダウンロード・ブラウザ再生機能を提供
- WhisperAPIと連携してNode-RED上で音声の文字起こしを実行し、結果を表示するデモを成功
- AtomicBatteryBaseと組み合わせることで小型でバッテリー駆動可能、200mAhで5-10分の使用に耐える



## M5StackチェーンデュアルキーをUIFlow2.0とUSB接続で試用 - 豊田さん

- M5Stackチェーンデュアルキーは2つのキーボードキーが搭載され、デフォルトでキーボードとして認識されるデバイス
- チェーン機能により横にジョイスティックなど様々なモジュールをU字型コネクタで連結可能
- ダウンロードモードへの移行は、USB端子を挿す前に右側のキーを押しっぱなしにして接続することで実現
- UIFlow2.0ではアカウント作成とログインが必要で、M5Burnerでファームウェアを書き込み
- USBデバイス選択画面でCOMポートを選び、ブラウザのWebSerialAPIを使って直接書き込み可能
- チュートリアル動画に従い、RGBフルカラーLEDを初期化して1秒ごとに色を変えるシンプルなプログラムを作成
- キーボードやマウスのHIDデバイスとして扱うブロックもUIFlow2.0上で提供され、公式サンプルも利用可能



## 閉会とまとめ

- 本日登壇いただいた全ての発表者とハッシュタグ付きポストをいただいた参加者に感謝の意を表明
- 次回第23回は昨年のペースを参考にゴールデンウィーク過ぎ頃の開催を予定し、日程決定後に共有予定
- IoTLT放送部による配信サポート、オンライン視聴者、ポスト投稿者への謝意を述べる
- 集合写真撮影を実施し、録画の確認も行って無事に終了

